var mwm=window.mwm||{};mwm.alerts=function(e,t,i,a){var n=e.alerts||{},o={alerts:{success:"alert-success",error:"alert-error",hide:"hide",hideForm:"hide",animation:"subtle-bounce",animated:"animated",invisible:"invisible",position:"center"},notify:{timeout:3,position:"top"},vex:{className:"vex-theme-default",focusFirstInput:!1},messenger:{message:{},position:{extraClasses:"messenger-fixed messenger-on-top-right"}},top:{prependTo:"body",bar:'<div id="FlashNotifications" class="notifications-flash"></div>',message:'<div class="notifications-flash--item notifications-flash--item_{{ level }}" data-content="{{ content }}" data-id="{{ id }}"><div class="notifications-flash--item-content">{{ content }}</div></div>',dismissable:'<span class="close notifications-flash--item-close" data-dismiss="notifications-flash--item" aria-label="Close"><span aria-hidden="true">&times;</span></span>',initCheck:function(){return n.top.$bar.length||t("#FlashNotifications").length},classes:{animated:"notifications-flash_in"}},flash:{levels:{top:"top",modal:"message",note:"notify"}}},s=function(){return t&&"function"==typeof t().modal},r=function(){return t&&"function"==typeof t().dialog},l=function(){return t&&t.hasOwnProperty("noticeAdd")},d=function(e,t){"top"==t?e.css({top:0,bottom:"auto"}).addClass("notification-top"):"bottom"==t?e.css({top:"auto",bottom:0}).addClass("notification-bottom"):"left"==t?e.css({left:0,right:"auto"}).addClass("notification-left"):"right"==t?e.css({left:"auto",right:0}).addClass("notification-right"):e.removeClass("notification-top notification-bottom notification-left notification-right")},m=function(e){return t.map(e.split(" "),function(e,t){return"messenger-on-"+t}).join(" ")},f=function(){o.top.initCheck()||(n.top.$bar=t(o.top.bar),t(o.top.prependTo).prepend(n.top.$bar))};return n.configure=function(e){o=t.extend(!0,{},o,e)},n.message=function(e,a){var l,m,f=e.Content?e.Content:e.message?e.message:e.content;if(e.redirect&&(t("body").addClass("loading-redirect"),window.location=e.redirect),f&&!e.hideMessage){e.$form&&e.$form.data("onMessageClass")&&e.$form.addClass(e.$form.data("onMessageClass"));var c=function(t,i){return function(){var n=e.$form?e.$form.find(".form-group.error"):[];!n.length&&i&&(n=i.parents("form").find(".form-group.error")),n.length&&n.first().find(":input:not(:hidden)").first().focus(),a&&a(),i&&m.trigger("mwm::alert",[t,e]),e.$form&&e.$form.trigger("mwm::alert",[t,e])}};if(s()&&!e.hideModal&&e.$modal&&!t(".modal-backdrop").length)e.Title&&e.$modal.find('[role="title"]').html(e.Title),f&&e.$modal.find('[role="content"]').html(f),e.$modal.modal(),e.$modal.off("hidden.bs.modal.forms.mwm").on("hidden.bs.modal.forms.mwm",c("modal",e.$modal)),n.clear(e);else if(!r()||e.hideModal||t(".ui-widget-overlay").length)if(!e.hideAlert&&e.$alert&&e.$alert.length)e.hideForm&&(e.$form?e.$form.addClass(o.alerts.hideForm):e.$alert.parents("form:first").addClass(o.alerts.hideForm)),e.success&&e.success!==!1?e.$alert.removeClass(o.alerts.error).addClass(o.alerts.success).html(f):e.$alert.removeClass(o.alerts.success).addClass(o.alerts.error).html(f),l=e.$alert.data("animate"),l||(l=o.alerts.animation),e.$alert.hasClass(o.alerts.invisible)?e.$alert.removeClass(o.alerts.invisible+" "+o.alerts.hide).addClass(o.alerts.animated+" "+l):e.$alert.hasClass(o.alerts.animated)?(e.$alert.removeClass(o.alerts.animated+" "+l).addClass(o.alerts.invisible),setTimeout(function(){e.$alert.removeClass(o.alerts.invisible+" "+o.alerts.hide).addClass(o.alerts.animated+" "+l)},50)):e.$alert.removeClass(o.alerts.hide),c("html",e.$alert)();else if(i){var u=e.positionAlert?e.positionAlert:o.alerts.position,p=i.dialog.alert(t.extend({},o.vex,{message:f})).bind("vexOpen.mwm",function(t,i){d(i.$vex,u),e.closeAfter||c("vex")()});e.closeAfter&&setTimeout(function(){i.close(p.data().vex.id),c("vex")()},1e3*e.closeAfter)}else r()?(m=t('<div class="ui-widget-modal-content">'+f+"</div>"),m.dialog({resizable:!1,title:e.Title?e.Title:null}),n.clear(e)):(alert(f),c("ui-alert")());else m=t('<div class="ui-widget-modal-content">'+f+"</div>"),m.dialog({modal:!0,title:e.Title?e.Title:null}),n.clear(e)}},n.notify=function(e,n){var s,r=e.Content?e.Content:e.message?e.message:e.content;if(r&&!e.hideMessage){var f=e.Timeout?e.Timeout:o.notify.timeout;f*=1e3;var c=e.position?e.position:o.notify.position;if(a){s=t.extend({},o.messenger.message,{message:r}),e.type&&(s.type=e.type);var u=t.extend({},o.messenger.position,e.advanced||{});c&&(u.extraClasses="messenger-fixed "+m(c)),a(u).post(s),e.$form&&e.$form.trigger("mwm::notification",["messenger",e]),t.event.trigger("mwm::notification",["messenger",e])}else if(i){s=t.extend({},o.vex,{message:r});var p=i.dialog.alert(s).bind("vexOpen.mwm",function(i,a){d(a.$vex,c),f||(n&&n(),e.$form&&e.$form.trigger("mwm::notification",["vex",e]),t.event.trigger("mwm::notification",["vex",e]))});f&&setTimeout(function(){p.data()&&p.data().vex&&p.data().vex.id&&i.close(p.data().vex.id),n&&n(),e.$form&&e.$form.trigger("mwm::notification",["vex",e]),t.event.trigger("mwm::notification",["vex",e])},f)}else l()?(s={text:r},e.type&&(s.type=e.type),f&&(s.stayTime=f),e.$form&&e.$form.trigger("mwm::notification",["noticeAdd",e]),t.noticeAdd(s),t.event.trigger("mwm::notification",["noticeAdd",e])):(alert(r),n&&n(),e.$form&&e.$form.trigger("mwm::notification",["alert",e]))}},n.button=function(a,n,s){var l=!0;if(!(a&&a.length&&a.data("alertContent")&&a.data("alertTarget")))return l;var d,m=a.data("alertTarget"),f=a.data("alertType")?a.data("alertType"):"alert",c=a.data("alertIf"),u=t({},o.vex,{message:a.data("alertContent"),buttons:a.data("alertButtons")?a.data("alertButtons"):{}}),p=function(o,m){if(o&&(u.message="string"==typeof o?o:t(o).text()),m&&(u.className=u.className?u.className+" "+m:m),u.buttons&&u.buttons.cancel&&(u.buttons.cancel.click=function(e){return e.data().vex.value=!1,i.close(e.data().vex.id)}),c&&!t(c).length)return l;if("alert"===f)i?i.dialog.alert(u):r()?(d=t('<div class="ui-widget-modal-content">'+u.message+"</div>"),u.title=a.data("alertTitle"),u.buttons={OK:function(){t(this).dialog("close")}},d.dialog(u)):alert(u.message);else if("confirm"===f){e&&e.forms&&e.forms.submit&&(e.forms.submit.submitting=!0),l=!1;var p=!1;if(i)u.callback=function(e){n&&e?n():s&&!e&&s()},i.dialog.confirm(u);else if(r()){if(d=t('<div class="ui-widget-modal-content">'+u.message+"</div>"),u.title=a.data("alertTitle"),2==t(u.buttons).length){var g=0;t(u.buttons).each(function(e){0===g?u.buttons[e]=function(){n&&n(),t(this).dialog("close")}:u.buttons[e]=function(){s&&s(),t(this).dialog("close")}})}else u.buttons={OK:function(){n&&n(),t(this).dialog("close")},Cancel:function(){s&&s(),t(this).dialog("close")}};d.dialog(u)}else p=confirm(u.message),n&&p?n():s&&!p&&s()}return null};if(m)if(0===m.indexOf("#")&&t(m).length){var g=t(m),v="";if(g.data("modal")){var h=g.find(".modal-content").find("[role=title]");h.length&&(v+=h[0].outerHTML),v+=g.find(".modal-content").find("[role=content]").html(),p(v,"button-alert-from-modal")}else v=g.html(),p(v,"button-alert-from-html")}else t.get(m,function(e){p(e,"button-alert-from-url")});else p(null,"button-alert-from-attribute");return l},n.clear=function(e){e.$alert&&e.$alert.length&&e.$alert.addClass(o.alerts.hide)},n.top=n.top||{},n.top.$bar=n.top.$bar||[],n.top.message=function(e){f();var i=e.Content?e.Content:e.message?e.message:e.content,a=e.id?e.id:i;if(i&&!n.top.$bar.find('[data-id="'+a+'"]').length){var s=t(o.top.message.replace(new RegExp("{{ level }}","g"),e.level||"info").replace(new RegExp("{{ content }}","g"),i).replace(new RegExp("{{ id }}","g"),a));if(e.dismissable){var r=t(o.top.dismissable);s.prepend(r),r.one("click",function(){n.top.clear(s),e.hasOwnProperty("dismiss_link")&&t.get(e.dismiss_link)})}n.top.$bar.append(s).addClass(o.top.classes.animated).parent().addClass(o.top.classes.animated),setTimeout(function(){s.addClass(o.top.classes.animated),e.timeout&&setTimeout(function(){s.removeClass(o.top.classes.animated)},1e3*e.timeout),n.top.$bar.trigger("mwm::top:alert",[s,e])},500)}},n.top.clear=function(e){f();var i=null;e?(i=e instanceof t?e:n.top.$bar.children().filter(function(){return t(this).data("id")==e}),i.removeClass(o.top.classes.animated),i.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd otransitionend transitionend",function(){t(this).remove()})):(n.top.$bar.removeClass(o.top.classes.animated),n.top.$bar.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd otransitionend transitionend",function(){n.top.$bar.text("").parent().removeClass(o.top.classes.animated)})),n.top.$bar.trigger("mwm::top:cleared",[i,e])},n.flash=function(e,t){for(var i=[],a=0;a<e.length;a++)e[a].type||(e[a].hasOwnProperty("level")&&o.flash.levels.hasOwnProperty(e[a].level)?e[a].type=o.flash.levels[e[a].level]:e[a].type="top"),t&&-1===i.indexOf(e[a].type)&&(i=i.push(e[a].type),"top"==e[a].type?n.top.clear():n.clear()),"function"==typeof n[e[a].type]?n[e[a].type](e[a]):n[e[a].type].message(e[a])},n}(window.mwm||{},window.jQuery||window.Zepto||window.Sprint,window.vex||null,window.Messenger||null),window.flash_message=function(e,t){if(e.hasOwnProperty("alerts")){var i=window.flash_message||{},a=function(t){t=t.sort(function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}),e.alerts.flash(t)};return i.ajax=function(e,n,o){t.isArray(n)||(n=n?n.split(","):[]);var s=[],r=function(){t.ajax({url:e,beforeSend:function(e){e.setRequestHeader("X-Notifications-Ajax",1)}}).done(function(e,r,l){if(l.getResponseHeader("X-Notifications-AuthoriseAt"))return void(window.location=l.getResponseHeader("X-Notifications-AuthoriseAt"));if(e!==!1&&(e&&t.isArray(e)&&(s=s.concat(e)),a(s),o)){var d=o.hasOwnProperty("link")?o.link:o,m=o.hasOwnProperty("timeout")?o.timeout:5e3,f=o.hasOwnProperty("before")?o.before:n;setTimeout(function(){i.ajax(d,f,o)},m)}})};if(n.length)for(var l=0,d=0;d<n.length;d++)t.get(n[d]).done(function(e){e&&t.isArray(e)&&(s=s.concat(e))}).always(function(){l++,l===n.length&&r()});else r()},i}}(window.mwm||{},window.jQuery||window.Zepto||window.Sprint||(window.mwm&&mwm.jquery?mwm.jquery:null));