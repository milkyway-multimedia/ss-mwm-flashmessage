!function(e){var t=function(t,o,n){function i(){null==n&&(n=e.forms||(window.mwm?window.mwm.forms:null)||null)}var a=e.alerts||{};null==o&&"function"==typeof require&&(o=require("jquery")),null==n&&"function"==typeof require&&(n=require("./forms.js")(t?t.forms:t,o,a));var s={alerts:{success:"alert-success",error:"alert-error",hide:"hide",hideForm:"hide",animation:"subtle-bounce",animated:"animated",invisible:"invisible",position:"center"},notify:{timeout:3,position:"top"},vex:{className:"vex-theme-default",focusFirstInput:!1},messenger:{message:{},position:{extraClasses:"messenger-fixed messenger-on-top-right"}},top:{prependTo:"body",bar:'<div id="FlashNotifications" class="notifications-flash"></div>',message:'<div class="notifications-flash--item notifications-flash--item_{{ level }}" data-content="{{ content }}" data-id="{{ id }}"><div class="notifications-flash--item-content">{{ content }}</div></div>',dismissable:'<span class="close notifications-flash--item-close" data-dismiss="notifications-flash--item" aria-label="Close"><span aria-hidden="true">&times;</span></span>',initCheck:function(){return a.top.$bar.length||o("#FlashNotifications").length},classes:{animated:"notifications-flash_in"}},flash:{levels:{top:"top",modal:"message",note:"notify"}}},r=function(){return o&&"function"==typeof o().modal},l=function(){return o&&"function"==typeof o().dialog},d=function(){return o&&o.hasOwnProperty("noticeAdd")},m=function(e,t){"top"==t?e.css({top:0,bottom:"auto"}).addClass("notification-top"):"bottom"==t?e.css({top:"auto",bottom:0}).addClass("notification-bottom"):"left"==t?e.css({left:0,right:"auto"}).addClass("notification-left"):"right"==t?e.css({left:"auto",right:0}).addClass("notification-right"):e.removeClass("notification-top notification-bottom notification-left notification-right")},f=function(e){return o.map(e.split(" "),function(e,t){return"messenger-on-"+t}).join(" ")},c=function(){s.top.initCheck()||(a.top.$bar=o(s.top.bar),o(s.top.prependTo).prepend(a.top.$bar))};return t&&(s=o.extend(!0,{},s,t)),a.configure=function(e){return s=o.extend(!0,{},s,e),a},a.setForms=function(e){return n=e,a},a.message=function(e,t){var n,i,d=e.Content?e.Content:e.message?e.message:e.content;if(e.redirect&&(o("body").addClass("loading-redirect"),window.location=e.redirect),d&&!e.hideMessage){e.$form&&e.$form.data("onMessageClass")&&e.$form.addClass(e.$form.data("onMessageClass"));var f=function(o,n){return function(){var a=e.$form?e.$form.find(".form-group.error"):[];!a.length&&n&&(a=n.parents("form").find(".form-group.error")),a.length&&a.first().find(":input:not(:hidden)").first().focus(),t&&t(),n&&i.trigger("mwm::alert",[o,e]),e.$form&&e.$form.trigger("mwm::alert",[o,e])}};if(r()&&!e.hideModal&&e.$modal&&!o(".modal-backdrop").length)e.Title&&e.$modal.find('[role="title"]').html(e.Title),d&&e.$modal.find('[role="content"]').html(d),e.$modal.modal(),e.$modal.off("hidden.bs.modal.forms.mwm").on("hidden.bs.modal.forms.mwm",f("modal",e.$modal)),a.clear(e);else if(!l()||e.hideModal||o(".ui-widget-overlay").length)if(!e.hideAlert&&e.$alert&&e.$alert.length)e.hideForm&&(e.$form?e.$form.addClass(s.alerts.hideForm):e.$alert.parents("form:first").addClass(s.alerts.hideForm)),e.success&&e.success!==!1?e.$alert.removeClass(s.alerts.error).addClass(s.alerts.success).html(d):e.$alert.removeClass(s.alerts.success).addClass(s.alerts.error).html(d),n=e.$alert.data("animate"),n||(n=s.alerts.animation),e.$alert.hasClass(s.alerts.invisible)?e.$alert.removeClass(s.alerts.invisible+" "+s.alerts.hide).addClass(s.alerts.animated+" "+n):e.$alert.hasClass(s.alerts.animated)?(e.$alert.removeClass(s.alerts.animated+" "+n).addClass(s.alerts.invisible),setTimeout(function(){e.$alert.removeClass(s.alerts.invisible+" "+s.alerts.hide).addClass(s.alerts.animated+" "+n)},50)):e.$alert.removeClass(s.alerts.hide),f("html",e.$alert)();else if(vex){var c=e.positionAlert?e.positionAlert:s.alerts.position,u=vex.dialog.alert(o.extend({},s.vex,{message:d})).bind("vexOpen.mwm",function(t,o){m(o.$vex,c),e.closeAfter||f("vex")()});e.closeAfter&&setTimeout(function(){vex.close(u.data().vex.id),f("vex")()},1e3*e.closeAfter)}else l()?(i=o('<div class="ui-widget-modal-content">'+d+"</div>"),i.dialog({resizable:!1,title:e.Title?e.Title:null}),a.clear(e)):(alert(d),f("ui-alert")());else i=o('<div class="ui-widget-modal-content">'+d+"</div>"),i.dialog({modal:!0,title:e.Title?e.Title:null}),a.clear(e);return a}},a.notify=function(e,t){var n,i=e.Content?e.Content:e.message?e.message:e.content;if(i&&!e.hideMessage){var r=e.Timeout?e.Timeout:s.notify.timeout;r*=1e3;var l=e.position?e.position:s.notify.position;if(messenger){n=o.extend({},s.messenger.message,{message:i}),e.type&&(n.type=e.type);var c=o.extend({},s.messenger.position,e.advanced||{});l&&(c.extraClasses="messenger-fixed "+f(l)),messenger(c).post(n),e.$form&&e.$form.trigger("mwm::notification",["messenger",e]),o.event.trigger("mwm::notification",["messenger",e])}else if(vex){n=o.extend({},s.vex,{message:i});var u=vex.dialog.alert(n).bind("vexOpen.mwm",function(n,i){m(i.$vex,l),r||(t&&t(),e.$form&&e.$form.trigger("mwm::notification",["vex",e]),o.event.trigger("mwm::notification",["vex",e]))});r&&setTimeout(function(){u.data()&&u.data().vex&&u.data().vex.id&&vex.close(u.data().vex.id),t&&t(),e.$form&&e.$form.trigger("mwm::notification",["vex",e]),o.event.trigger("mwm::notification",["vex",e])},r)}else d()?(n={text:i},e.type&&(n.type=e.type),r&&(n.stayTime=r),e.$form&&e.$form.trigger("mwm::notification",["noticeAdd",e]),o.noticeAdd(n),o.event.trigger("mwm::notification",["noticeAdd",e])):(alert(i),t&&t(),e.$form&&e.$form.trigger("mwm::notification",["alert",e]));return a}},a.button=function(e,t,a){var r=!0;if(!(e&&e.length&&e.data("alertContent")&&e.data("alertTarget")))return r;var d,m=e.data("alertTarget"),f=e.data("alertType")?e.data("alertType"):"alert",c=e.data("alertIf"),u=o({},s.vex,{message:e.data("alertContent"),buttons:e.data("alertButtons")?e.data("alertButtons"):{}}),p=function(s,m){if(s&&(u.message="string"==typeof s?s:o(s).text()),m&&(u.className=u.className?u.className+" "+m:m),u.buttons&&u.buttons.cancel&&(u.buttons.cancel.click=function(e){return e.data().vex.value=!1,vex.close(e.data().vex.id)}),c&&!o(c).length)return r;if("alert"===f)vex?vex.dialog.alert(u):l()?(d=o('<div class="ui-widget-modal-content">'+u.message+"</div>"),u.title=e.data("alertTitle"),u.buttons={OK:function(){o(this).dialog("close")}},d.dialog(u)):alert(u.message);else if("confirm"===f){i(),n&&n.submit&&(n.submit.submitting=!0),r=!1;var p=!1;if(vex)u.callback=function(e){t&&e?t():a&&!e&&a()},vex.dialog.confirm(u);else if(l()){if(d=o('<div class="ui-widget-modal-content">'+u.message+"</div>"),u.title=e.data("alertTitle"),2==o(u.buttons).length){var g=0;o(u.buttons).each(function(e){0===g?u.buttons[e]=function(){t&&t(),o(this).dialog("close")}:u.buttons[e]=function(){a&&a(),o(this).dialog("close")}})}else u.buttons={OK:function(){t&&t(),o(this).dialog("close")},Cancel:function(){a&&a(),o(this).dialog("close")}};d.dialog(u)}else p=confirm(u.message),t&&p?t():a&&!p&&a()}return null};if(m)if(0===m.indexOf("#")&&o(m).length){var g=o(m),v="";if(g.data("modal")){var h=g.find(".modal-content").find("[role=title]");h.length&&(v+=h[0].outerHTML),v+=g.find(".modal-content").find("[role=content]").html(),p(v,"button-alert-from-modal")}else v=g.html(),p(v,"button-alert-from-html")}else o.get(m,function(e){p(e,"button-alert-from-url")});else p(null,"button-alert-from-attribute");return r},a.clear=function(e){return e.$alert&&e.$alert.length&&e.$alert.addClass(s.alerts.hide),a},a.top=a.top||{},a.top.$bar=a.top.$bar||[],a.top.message=function(e){c();var t=e.Content?e.Content:e.message?e.message:e.content,n=e.id?e.id:t;if(t&&!a.top.$bar.find('[data-id="'+n+'"]').length){var i=o(s.top.message.replace(new RegExp("{{ level }}","g"),e.level||"info").replace(new RegExp("{{ content }}","g"),t).replace(new RegExp("{{ id }}","g"),n));if(e.dismissable){var r=o(s.top.dismissable);i.prepend(r),r.one("click",function(){a.top.clear(i)})}return a.top.$bar.append(i).addClass(s.top.classes.animated).parent().addClass(s.top.classes.animated),setTimeout(function(){i.addClass(s.top.classes.animated),e.timeout&&setTimeout(function(){i.removeClass(s.top.classes.animated)},1e3*e.timeout),a.top.$bar.trigger("mwm::top:alert",[i,e])},500),a}},a.top.clear=function(e){c();var t=null;return e?(t=e instanceof o?e:a.top.$bar.children().filter(function(){return o(this).data("id")==e}),t.removeClass(s.top.classes.animated),t.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd otransitionend transitionend",function(){o(this).remove()})):(a.top.$bar.removeClass(s.top.classes.animated),a.top.$bar.one("webkitTransitionEnd mozTransitionEnd MSTransitionEnd otransitionend transitionend",function(){a.top.$bar.text("").parent().removeClass(s.top.classes.animated)})),a.top.$bar.trigger("mwm::top:cleared",[t,e]),a},a.flash=function(e,t){for(var o=[],n=0;n<e.length;n++)e[n].type||(e[n].hasOwnProperty("level")&&s.flash.levels.hasOwnProperty(e[n].level)?e[n].type=s.flash.levels[e[n].level]:e[n].type="top"),t&&o.indexOf(e[n].type)===-1&&(o=o.push(e[n].type),"top"==e[n].type?a.top.clear():a.clear()),"function"==typeof a[e[n].type]?a[e[n].type](e[n]):a[e[n].type].message(e[n]);return a},a};"object"==typeof module&&"object"==typeof module.exports&&e===module.exports?module.exports=t:(window.mwm=e||window.mwm,window.mwm.alerts=t({},window.jQuery||window.Zepto||window.Sprint,window.vex||null,window.Messenger||null,e.forms||window.mwm.forms||null))}("object"==typeof module&&"object"==typeof module.exports?module.exports:window.mwm||{}),window.flash_message=function(e,t){if(e.hasOwnProperty("alerts")){var o=window.flash_message||{},n=function(t){t=t.sort(function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0}),e.alerts.flash(t)};return o.ajax=function(e,i,a){t.isArray(i)||(i=i?i.split(","):[]);var s=[],r=function(){t.ajax({url:e,beforeSend:function(e){e.setRequestHeader("X-Notifications-Ajax",1)}}).done(function(e,r,l){if(l.getResponseHeader("X-Notifications-AuthoriseAt"))return void(window.location=l.getResponseHeader("X-Notifications-AuthoriseAt"));if(e!==!1&&(e&&t.isArray(e)&&(s=s.concat(e)),n(s),a)){var d=a.hasOwnProperty("link")?a.link:a,m=a.hasOwnProperty("timeout")?a.timeout:5e3,f=a.hasOwnProperty("before")?a.before:i;setTimeout(function(){o.ajax(d,f,a)},m)}})};if(i.length)for(var l=0,d=0;d<i.length;d++)t.get(i[d]).done(function(e){e&&t.isArray(e)&&(s=s.concat(e))}).always(function(){l++,l===i.length&&r()});else r()},o}}(window.mwm||{},window.jQuery||window.Zepto||window.Sprint||(window.mwm&&mwm.jquery?mwm.jquery:null));